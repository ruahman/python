name = docker-py
ports = 5000:5000
network = docker-py-net

docker-build:
	docker build -t $(name) .
	touch docker-build

docker-net:
	docker network create $(network)
	touch docker-net

.PHONY: docker-net-rm
docker-net-rm:
	docker network rm $(network)
	rm docker-net

.PHONY: docker-run
docker-run: docker-build docker-net
	docker run --name $(name) --network=$(network) -v $(shell pwd):/code/ -w /code -d -p $(ports) $(name)

.PHONY: docker-stop
docker-stop:
	docker stop $(name) 

.PHONY: docker-rm
docker-rm:
	docker rm $(name)

.PHONY: docker-rmi
docker-rmi:
	docker rmi $(name)
	rm docker-build

.PHONY: docker-shell
docker-shell: docker-build docker-net
	docker run --name $(name) --network=$(network) -v $(shell pwd):/code/ -w /code -p $(ports) -it --rm $(name) /bin/bash

.PHONY: lint
lint:
	pylint --rcfile=lint.rc src/*.py

.PHONY: clean
clean:
	rm -rf src/__pycache__

.PHONY: test
test:
	foo=$(arg1)
	if "$(arg1)" -z "foo"; then echo foobar; fi;


